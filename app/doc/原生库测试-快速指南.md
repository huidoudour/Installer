# 🚀 原生库测试 - 快速指南

## 📱 立即开始测试

### 1️⃣ 最简单方式(推荐)

```
打开应用 → 进入"设置"页面 → 长按"关于"按钮(1-2秒) → 自动进入测试界面
```

**演示:**
```
┌─────────────────┐
│   设置界面      │
│                 │
│  [通知设置]     │
│  [语言设置]     │
│  [主题设置]     │
│                 │
│  长按 👇        │
│  [关于] 按钮    │ ← 按住不放 1-2 秒
│                 │
└─────────────────┘
         ↓
┌─────────────────┐
│ 原生库测试界面  │
│                 │
│ ✅ 库加载成功   │
│ 📊 性能测试...  │
│ 🔐 哈希测试...  │
│                 │
└─────────────────┘
```

---

## ✅ 你会看到什么

### 成功加载:
```
=== 原生库测试 ===

✅ 原生库加载成功!

【测试 1】库信息:
📦 Native Library Information
Library Name: installer-native
Version: 1.0.0
CPU Architecture: arm64-v8a
Status: ✅ Loaded

【测试 2】性能对比:
🚀 Performance Comparison
Iterations: 10,000,000
Java Time: 25,432 μs
C++ Time: 8,156 μs
Speedup: 3.12x
✅ Native is faster!

【测试 3】哈希性能:
🔐 Hash Performance Test
...

✅ 所有测试完成!
```

### 加载失败:
```
=== 原生库测试 ===

❌ 原生库加载失败!

错误信息:
dlopen failed: library "libinstaller-native.so" not found

请检查:
1. NDK 是否正确安装
2. CMake 配置是否正确
3. 架构是否匹配 (arm64-v8a 或 x86_64)
```

---

## 🐛 如果加载失败

### 快速修复步骤:

```powershell
# 1. 清理项目
.\gradlew clean

# 2. 重新构建
.\gradlew assembleDebug

# 3. 重新安装 APK
# 在 Android Studio 中点击 Run
```

### 检查 NDK 是否安装:

```
Android Studio 
  → Tools 
  → SDK Manager 
  → SDK Tools 标签
  → 勾选 "NDK (Side by side)" 
  → 勾选 "CMake"
  → Apply
```

---

## 📊 关于构建警告

### 常见的 4 个警告:

| 警告 | 严重性 | 解决状态 |
|------|--------|---------|
| NDK 版本未指定 | 中 | ✅ 已修复 |
| CMake 变量未使用 | 低 | ⚠️ 可忽略 |
| ABI 过滤器重复 | 低 | ✅ 已优化 |
| C++ 库选择提示 | 低 | ✅ 已配置 |

**结论:** 
- ✅ 所有关键配置已优化
- ⚠️ 剩余警告是信息性的,不影响功能
- ✅ 可以正常构建和使用

详细说明请查看: [构建警告说明.md](构建警告说明.md)

---

## 🎯 快速检查清单

使用测试功能前,确认:

- [ ] 已在 Android Studio 中同步项目
- [ ] 已成功构建 APK (无错误)
- [ ] 已安装到设备或模拟器
- [ ] 设备架构为 arm64-v8a 或 x86_64

---

## 💡 使用技巧

### 技巧 1: 快速进入测试
**长按"关于"按钮** 是最快的方式,无需修改任何代码

### 技巧 2: 查看详细日志
在 Android Studio 的 Logcat 中过滤:
```
Tag: NativeHelper
Tag: InstallerNative
```

### 技巧 3: 多次测试
性能测试会受设备状态影响,建议:
- 关闭省电模式
- 清理后台应用
- 多次运行取平均值

### 技巧 4: 不同设备对比
在真机和模拟器上分别测试,对比性能差异

---

## 📖 相关文档

| 文档 | 说明 |
|------|------|
| [如何使用原生库测试.md](如何使用原生库测试.md) | 详细使用说明 |
| [构建警告说明.md](构建警告说明.md) | 警告解决方案 |
| [原生库集成完成说明.md](原生库集成完成说明.md) | 完整配置总结 |
| [NATIVE_QUICKSTART.md](NATIVE_QUICKSTART.md) | 开发者指南 |

---

## ❓ 常见问题

### Q: 长按"关于"按钮没反应?
**A:** 确保已重新构建并安装最新版本的 APK

### Q: 测试显示加载失败?
**A:** 
1. 检查 NDK 和 CMake 是否安装
2. 运行 `.\gradlew clean assembleDebug`
3. 查看 [构建警告说明.md](构建警告说明.md)

### Q: 性能测试结果不理想?
**A:** 
- 模拟器性能可能较差,建议在真机测试
- 确保设备不在省电模式
- 多次运行取平均值

### Q: 找不到测试界面?
**A:** 
- 确认已同步项目
- 检查 AndroidManifest.xml 中是否注册了 NativeTestActivity
- 重新 Clean & Rebuild

---

## 🎉 总结

✅ **已完成:**
- C++ 原生库集成
- 测试界面创建
- 长按"关于"按钮快捷入口
- 构建警告优化

✅ **使用方式:**
- 设置页面 → 长按"关于" → 进入测试

✅ **测试内容:**
- 库加载验证
- 性能对比测试
- 哈希计算演示

**开始测试吧!** 🚀

---

**提示:** 这是开发者工具,仅用于验证原生库是否正常工作。
